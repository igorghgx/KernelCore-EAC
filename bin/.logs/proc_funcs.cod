; Listing generated by Microsoft (R) Optimizing Compiler Version 19.36.32532.0 

include listing.inc

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	ExPoolZeroingNativelySupported
;	COMDAT ExPoolZeroingNativelySupported
_BSS	SEGMENT
ExPoolZeroingNativelySupported DB 01H DUP (?)
_BSS	ENDS
PUBLIC	?get_by_id@process@@YAPEAU_KPROCESS@@IPEAJ@Z	; process::get_by_id
EXTRN	__imp_PsLookupProcessByProcessId:PROC
;	COMDAT pdata
pdata	SEGMENT
$pdata$?get_by_id@process@@YAPEAU_KPROCESS@@IPEAJ@Z DD imagerel $LN8
	DD	imagerel $LN8+52
	DD	imagerel $unwind$?get_by_id@process@@YAPEAU_KPROCESS@@IPEAJ@Z
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$?get_by_id@process@@YAPEAU_KPROCESS@@IPEAJ@Z DD 040602H
	DD	060d1602H
	DD	030023206H
xdata	ENDS
; Function compile flags: /Ogtp
; File C:\Users\leonk\OneDrive\Desktop\EAC\driver\process\proc_funcs.cpp
;	COMDAT ?get_by_id@process@@YAPEAU_KPROCESS@@IPEAJ@Z
_TEXT	SEGMENT
pid$ = 48
pstatus$ = 56
hProc$ = 64
?get_by_id@process@@YAPEAU_KPROCESS@@IPEAJ@Z PROC	; process::get_by_id, COMDAT

; 5    : {

$LN8:
  00000	40 53		 push	 rbx
  00002	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  00006	48 8b da	 mov	 rbx, rdx

; 6    : 	PEPROCESS hProc;
; 7    : 	NTSTATUS status = PsLookupProcessByProcessId( ( HANDLE ) pid, &hProc );

  00009	8b c9		 mov	 ecx, ecx
  0000b	48 8d 54 24 40	 lea	 rdx, QWORD PTR hProc$[rsp]
  00010	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_PsLookupProcessByProcessId

; 8    : 	if ( !NT_SUCCESS( status ) )

  00016	85 c0		 test	 eax, eax
  00018	79 0f		 jns	 SHORT $LN2@get_by_id

; 9    : 	{
; 10   : 		if ( pstatus )

  0001a	48 85 db	 test	 rbx, rbx
  0001d	74 02		 je	 SHORT $LN3@get_by_id

; 11   : 			*pstatus = status;

  0001f	89 03		 mov	 DWORD PTR [rbx], eax
$LN3@get_by_id:

; 12   : 		return NULL;

  00021	33 c0		 xor	 eax, eax

; 15   : }

  00023	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00027	5b		 pop	 rbx
  00028	c3		 ret	 0
$LN2@get_by_id:

; 13   : 	}
; 14   : 	return hProc;

  00029	48 8b 44 24 40	 mov	 rax, QWORD PTR hProc$[rsp]

; 15   : }

  0002e	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00032	5b		 pop	 rbx
  00033	c3		 ret	 0
?get_by_id@process@@YAPEAU_KPROCESS@@IPEAJ@Z ENDP	; process::get_by_id
_TEXT	ENDS
END
